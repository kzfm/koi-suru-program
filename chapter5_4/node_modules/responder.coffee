class Responder
 constructor: (@name, @dictionary) ->
 response: (input) -> ''

select_random = (l) -> l[Math.floor(Math.random()*l.length)]

exports.WhatResponder = class extends Responder
  response: (input) -> input + "ってなに？"

exports.RandomResponder = class extends Responder
  constructor: (@name, @dictionary) ->
    super @name, @dictionary
  response: (input) -> select_random(@dictionary.random)

exports.PatternResponder = class extends Responder
  constructor: (@name, @dictionary) ->
    super @name, @dictionary
  response: (input) ->
    for ptn in @dictionary.pattern
      if m = input.match(ptn['pattern'])
        resp = select_random(ptn['phrases'].split('|'))
        res = resp.replace(/ptn['pattern']/,m[0])
    res ?= select_random(@dictionary.random)

